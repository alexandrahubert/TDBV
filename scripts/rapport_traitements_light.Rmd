---
title: "Hydromorphologie des têtes de bassins versants"
subtitle: "Analyses préliminaires sur les stations de référence hydromorphologique du massif armoricain"
author: "Julien Boëton, Pascal Irz, Alexandra Hubert & Mikaël Le Bihan"
date: "22/07/2022"
output:
  bookdown::html_document2: 
    fig_caption: true
 #   tab_caption: yes
    number_sections: true
    global_numbering: true
    toc: true
    toc_float:
      toc_collapsed: true
      toc_depth: 2
   # number_sections: true
    code_folding: hide
  word_document: default
  pdf_document: default
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```


# Introduction

Le présent document expose les analyses préliminaires réalisées dans le cadre d'un stage de première année à l'[ENGEES](https://engees.unistra.fr/) réalisé à la Direction Régionale Bretagne de l'Office Français de la Biodiversité. Il vise à esquisser ce que pourrait être des "conditions de référence" pour le chevelu hydrographique dans l'HER de niveau 1 "massif armoricain". L'établissement de telles références fournirait une base pour l'ingénierie écologique de restauration de ces petits cours d'eau dans la région.


Dans cet objectif, des données ont été collectées par plusieurs étudiants stagiaires entre 2013 et 2022 sur des ruisseaux réputés non-impactés. Il s'agissait de caractériser finement les caractéristiques hydromorphologiques du lit mineur et de la ripisylve pour des tronçons de rang de Strahler allant de 1 à 4, avec une majorité de cours d'eau de rang 1. Les caractéristiques principales des bassins versants en amont des tronçons ont été obtenues par géotraitement sous le logiciel QGis (ref).

Afin de mettre en perspective les résultats obtenus, les mêmes analyses ont été menées sur les cours d'eau qualifiés "de référence" de [l'IED Carhyce](https://analytics.huma-num.fr/ied_carhyce/) en sélectionnant la même hydro-écorégion. Les protocoles de terrain ne sont pas identiques, cependant certaines grandeurs sont similaires et se recoupent.

```{r}
# chargement des packages
library(dplyr)
library(ggplot2)
library(ggpubr)
library(magrittr)
library(plotly)
library(flextable)
library(shiny)

# chargement du tableau de données au format RData
load(file = "ref.RData")

# chargement des fonctions
source(file = "00_fonctions.R")
```

Le tableau assemblé comprend `r nrow(ref)` lignes correspondant à `r ref %>% filter(jeu_donnees != 'carhyce_ref_armo') %>% nrow()` cours d'eau étudiés par la DR Bretagne et `r ref %>% filter(jeu_donnees == 'carhyce_ref_armo') %>% nrow()` cours d'eau dont les données proviennent de [l'IED Carhyce](https://analytics.huma-num.fr/ied_carhyce/). Il a été distingué, parmi les sources de données de la DR OFB Bretagne, celles issues de Galineau (2020) des autres (Jan, 2013 ; Bossis, 2014 pour les rangs 1) car il s'agit de cours d'eau intermédiaires, en terme de taille, entre, d'une part, les rangs 0 et 1 (autres stages) et, d'autre part, des cours d'eau plus importants (Carhyce). Le tableau de données est téléchargeable.

```{r}
ref %>%
  downloadthis::download_this(
    output_name = "hydromorpho_ref_armo",
    output_extension = ".xlsx",
    button_label = "Télécharger en Excel",
    button_type = "success",
    has_icon = TRUE,
    icon = "fa fa-save",
    csv2 = TRUE,
  )

ref %>% 
  select(-Code_tron,
         -dist_inter_rad,
         -Coef_sinuo) %>%
  mutate_at(vars(pente_eau_m_m, l_h),
            function(x) round(x, 5)) %>% 
  DT::datatable(caption = "Table 1")
```



L'hypothèse sous-jacente aux analyses est que les caractéristiques naturelles d'un bassin versant "contraignent" celles de son réseau hydrographique. Le phénomène est bien connu sur les grands cours d'eau, mais les têtes de bassins ont été beaucoup moins étudiées. 

Les caractéristiques du bassin qui vont être prises en compte ici sont :

- Sa *superficie*, en km².
- Sa *pente.* Ici c'est la pente longitudinale de la ligne d'eau du cours d'eau au niveau de la station qui est prise comme *proxy* de la pente du bassin. Elle est exprimée en m/m.

Les variables de réponse sont *la largeur et la hauteur de plein bord* (moyennes sur l'ensemble des transects, en mètres) ainsi que le rapport entre les deux, largeur / hauteur.

# Distribution des variables

Les distributions des variables sont données ci-dessous en comparant les jeux de données afin de bien donner les ordres de grandeur. Celles qui prennent des valeurs très dispersées sont représentées en échelle $log$ (base 10).

```{r}
# chargement du tableau de données au format RData
load(file = "graphiques.RData")
```

```{r}
g_densite
```

